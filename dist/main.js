(()=>{"use strict";(()=>{const e=document.querySelector("ul"),t=()=>{e.classList.toggle("menu-active"),e.classList.toggle("animate__animated"),e.classList.toggle("animate__bounceInDown")};document.addEventListener("click",(o=>{let c=o.target;c.matches(".club-select p")?t():(c=c.closest(".club-select"),!c&&e.classList.contains("menu-active")&&t())}))})(),(()=>{const e=document.querySelector(".fixed-gift"),t=document.getElementById("gift"),o=document.querySelector("#gift .form-content"),c=()=>{t.classList.toggle("popup_opened")};e&&(e.addEventListener("click",(()=>{document.documentElement.clientWidth>768?(e.style.display="none",o.classList.add("animate__animated"),o.classList.add("animate__bounceIn"),c()):(e.style.display="none",c())})),t.addEventListener("click",(e=>{let t=e.target;t.matches(".close_icon")||t.matches(".close-btn")?c():(t=t.closest(".form-content"),t||c())})))})(),(()=>{const e=document.querySelector(".menu-button img"),t=document.querySelector(".popup-menu"),o=document.querySelector(".top-menu");e.addEventListener("click",(()=>{t.classList.add("animate__animated"),t.classList.add("animate__fadeIn"),t.classList.add("animate__faster"),t.style.display="flex"})),t.addEventListener("click",(e=>{const o=e.target;(o.matches(".close-menu-btn img")||o.matches(".popup-menu li a"))&&(t.style.display="none")})),window.addEventListener("scroll",(()=>{document.documentElement.clientWidth<768&&document.documentElement.scrollTop>o.offsetTop?o.classList.add("burger__fixed"):o.classList.remove("burger__fixed")}))})(),(()=>{const e=(e,t)=>{e.preventDefault();const o=t.getAttribute("href");document.querySelector(o).scrollIntoView({behavior:"smooth",block:"start"})};document.addEventListener("click",(t=>{let o=t.target;o.matches('a[href*="#"]')&&!o.matches(".open-popup")?e(t,o):(o=o.closest("#totop"),o&&e(t,o))}))})(),(()=>{const e=document.getElementById("totop");e.style.display="none",window.addEventListener("scroll",(()=>{window.pageYOffset>document.getElementById("header").offsetHeight?e.style.display="block":e.style.display="none"}))})(),(()=>{const e=document.querySelector(".open-popup"),t=document.getElementById("free_visit_form");e.addEventListener("click",(()=>{t.classList.add("popup_opened")})),t.addEventListener("click",(e=>{let o=e.target;o.matches(".close-form img")?(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))):(o=o.closest(".form-content"),o||(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))))}))})(),(()=>{const e=document.querySelector(".callback-btn"),t=document.getElementById("callback_form");e.addEventListener("click",(()=>{t.classList.add("popup_opened")})),t.addEventListener("click",(e=>{let o=e.target;o.matches(".close-form img")?(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))):(o=o.closest(".form-content"),o||(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))))}))})(),(()=>{if(document.getElementById("price-total")){const e=document.getElementById("card_order"),t=document.querySelectorAll("input[name='card-type']"),o=document.getElementById("price-total"),c=document.getElementById("promo"),n=e=>e.match(/class="cost">\d+<span/g).filter((e=>!e.includes("day"))).map((e=>+e.replace(/\D/g,""))),s=e=>{t.forEach(((t,n)=>{t.dataset.price=e[n],t.checked&&(o.textContent=t.dataset.price,"ТЕЛО2020"===c.value&&(o.textContent=Math.round(.7*t.dataset.price)))})),document.querySelector(".time").addEventListener("change",(e=>{const t=e.target;t&&(o.textContent=t.dataset.price,"ТЕЛО2020"===c.value&&(o.textContent=Math.round(.7*t.dataset.price)))}))};fetch("./mozaika.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>n(e))).then((e=>{s(e)})).catch((e=>{console.error(e)})),e.addEventListener("change",(e=>{const t=e.target;t.matches("#card_leto_mozaika")&&fetch("./mozaika.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>n(e))).then((e=>{s(e)})).catch((e=>{console.error(e)})),t.matches("#card_leto_schelkovo")&&fetch("./schelkovo.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>n(e))).then((e=>{s(e)})).catch((e=>{console.error(e)}))})),c.addEventListener("input",(e=>{"ТЕЛО2020"===c.value?(c.style.border="2px solid green",o.textContent=Math.round(.7*o.textContent)):(c.style.border="",t.forEach((e=>{e.checked&&(o.textContent=e.dataset.price)})))}))}})(),(()=>{const e=document.getElementById("form1"),t=document.getElementById("form2"),o=document.querySelector(".preloader"),c=document.getElementById("card_order"),n=document.getElementById("thanks"),s=document.getElementById("thanks__error"),a=document.getElementById("promo"),l=document.getElementById("price-total"),r=document.querySelectorAll("input[name='card-type']");n.addEventListener("click",(e=>{let t=e.target;t.matches(".close-form img")||t.matches("#thanks .close-btn")?n.classList.remove("popup_opened"):(t=t.closest(".form-content"),t||n.classList.remove("popup_opened"))})),s.addEventListener("click",(e=>{let t=e.target;t.matches(".close-form img")||t.matches("#thanks__error .close-btn")?s.classList.remove("popup_opened"):(t=t.closest(".form-content"),t||s.classList.remove("popup_opened"))}));const d=(d,p)=>{p.preventDefault();const i=d.querySelector("[type='checkbox']"),m=d.querySelector("#personalDataAgreement");if(i&&!1===i.checked)return m.classList.add("popup_opened"),void(d===c&&(m.style.color="black",m.style.textAlign="left"));m&&m.classList.remove("popup_opened"),d===c&&a&&(a.style.border="",r.forEach((e=>{e.checked&&(l.textContent=e.dataset.price)}))),d.append(o),o.style.display="block";const u=new FormData(d),h={};for(const e of u.entries())h[e[0]]=e[1];(e=>fetch("./se4444rver.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(h).then((c=>{if(200!==c.status)throw new Error("network failed");o.style.display="none",d===e||d===t?(d.parentElement.parentElement.parentElement.classList.remove("popup_opened"),n.classList.add("popup_opened"),setTimeout((()=>{n.classList.remove("popup_opened")}),5e3)):(n.classList.add("popup_opened"),setTimeout((()=>{n.classList.remove("popup_opened")}),5e3))})).catch((c=>{console.error(c),o.style.display="none",d===e||d===t?(d.parentElement.parentElement.parentElement.classList.remove("popup_opened"),s.classList.add("popup_opened"),setTimeout((()=>{s.classList.remove("popup_opened")}),5e3)):(s.classList.add("popup_opened"),setTimeout((()=>{s.classList.remove("popup_opened")}),5e3))})),d.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&(e.checked=!1)}))};document.addEventListener("submit",(e=>{const t=e.target;t.matches("#form1")&&d(t,e),t.matches("#form2")&&d(t,e),t.matches("#banner-form")&&d(t,e),t.matches("#card_order")&&d(t,e),t.matches("#footer_form")&&d(t,e)}))})(),document.addEventListener("input",(e=>{const t=e.target;t.matches("input[type='tel']")&&(t.value=t.value.replace(/[^\d+]/g,""),t.value.length>12&&(t.value=t.value.slice(0,12))),t.matches("input[name='name']")&&!t.matches("input#promo")&&(t.value=t.value.replace(/[^а-яё\s]/gi,"").replace(/\s+/g," ").replace(/^\s/g,""))})),document.addEventListener("blur",(e=>{const t=e.target;if(t.matches("input[type='tel']")&&"+"!==t.value.charAt(0)&&"7"!==t.value.charAt(1)&&(t.value="+7"+t.value.slice(2)),t.matches("input[name='name']")&&!t.matches("input#promo")&&""!==t.value.trim()){let e=t.value.split(/\s+/);if(e.length){let o=e.map((e=>{if(""!=e)return e[0].toUpperCase()+e.slice(1).toLowerCase()}));t.value=o.join(" ").replace(/\s$/g,"")}}}),!0),(()=>{const e=document.querySelector(".main-slider"),t=e.querySelectorAll(".slide"),o=[];let c,n=0;(()=>{const e=document.querySelector(".header_slider-dots");for(let c=0;c<t.length;c++){const t=document.createElement("li");t.classList.add("dot"),0===c&&t.classList.add("dot-active"),o.push(t),e.appendChild(t)}})();const s=(e,t,o)=>{e[t].style.display=o},a=(e,t,o)=>{e[t].style.display=o},l=(e,t,o)=>{e[t].classList.remove(o)},r=(e,t,o)=>{e[t].classList.add(o)},d=()=>{s(t,n,"none"),l(o,n,"dot-active"),n++,n>=t.length&&(n=0),a(t,n,"block"),r(o,n,"dot-active")},p=(e=2e3)=>{c=setInterval(d,e)};e.addEventListener("click",(e=>{e.preventDefault();const c=e.target;c.matches(".dot")&&(s(t,n,"none"),l(o,n,"dot-active"),c.matches(".dot")&&o.forEach(((e,t)=>{e===c&&(n=t)})),n>=t.length&&(n=0),n<0&&(n=t.length-1),a(t,n,"block"),r(o,n,"dot-active"))})),e.addEventListener("mouseover",(e=>{e.target.matches(".dot")&&clearInterval(c)})),e.addEventListener("mouseout",(e=>{e.target.matches(".dot")&&p(5e3)})),p(5e3)})(),(()=>{const e=document.querySelector(".gallery-slider").querySelectorAll(".slide"),t=[];let o,c=0;(()=>{const o=document.querySelector(".slider-dots");for(let c=0;c<e.length;c++){const e=document.createElement("li");e.classList.add("dot"),0===c&&e.classList.add("dot-active"),t.push(e),o.appendChild(e)}})();const n=(e,t,o)=>{e[t].classList.remove(o)},s=(e,t,o)=>{e[t].classList.add(o)},a=()=>{n(e,c,"slide_active"),n(t,c,"dot-active"),c++,c>=e.length&&(c=0),s(e,c,"slide_active"),s(t,c,"dot-active")};((e=2e3)=>{o=setInterval(a,e)})(5e3)})()})();