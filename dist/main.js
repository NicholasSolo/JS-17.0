(()=>{"use strict";(()=>{const e=document.querySelector("ul"),t=()=>{e.classList.toggle("menu-active"),e.classList.toggle("animate__animated"),e.classList.toggle("animate__bounceInDown")};document.addEventListener("click",(o=>{let n=o.target;n.matches(".club-select p")?t():(n=n.closest(".club-select"),!n&&e.classList.contains("menu-active")&&t())}))})(),(()=>{const e=document.querySelector(".fixed-gift"),t=document.getElementById("gift"),o=document.querySelector("#gift .form-content"),n=()=>{t.classList.toggle("popup_opened")};e&&(e.addEventListener("click",(()=>{document.documentElement.clientWidth>768?(e.style.display="none",o.classList.add("animate__animated"),o.classList.add("animate__bounceIn"),n()):(e.style.display="none",n())})),t.addEventListener("click",(e=>{let t=e.target;t.matches(".close_icon")||t.matches(".close-btn")?n():(t=t.closest(".form-content"),t||n())})))})(),(()=>{const e=document.querySelector(".menu-button img"),t=document.querySelector(".popup-menu"),o=document.querySelector(".top-menu");e.addEventListener("click",(()=>{t.classList.add("animate__animated"),t.classList.add("animate__fadeIn"),t.classList.add("animate__faster"),t.style.display="flex"})),t.addEventListener("click",(e=>{const o=e.target;(o.matches(".close-menu-btn img")||o.matches(".popup-menu li a"))&&(t.style.display="none")})),window.addEventListener("scroll",(()=>{document.documentElement.clientWidth<768&&document.documentElement.scrollTop>o.offsetTop?o.classList.add("burger__fixed"):o.classList.remove("burger__fixed")}))})(),(()=>{const e=(e,t)=>{e.preventDefault();const o=t.getAttribute("href");document.querySelector(o).scrollIntoView({behavior:"smooth",block:"start"})};document.addEventListener("click",(t=>{let o=t.target;o.matches('a[href*="#"]')&&!o.matches(".open-popup")?e(t,o):(o=o.closest("#totop"),o&&e(t,o))}))})(),(()=>{const e=document.getElementById("totop");e.style.display="none",window.addEventListener("scroll",(()=>{window.pageYOffset>document.getElementById("header").offsetHeight?e.style.display="block":e.style.display="none"}))})(),(()=>{const e=document.querySelector(".open-popup"),t=document.getElementById("free_visit_form");e.addEventListener("click",(()=>{t.classList.add("popup_opened")})),t.addEventListener("click",(e=>{let o=e.target;o.matches(".close-form img")?(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))):(o=o.closest(".form-content"),o||(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))))}))})(),(()=>{const e=document.querySelector(".callback-btn"),t=document.getElementById("callback_form");e.addEventListener("click",(()=>{t.classList.add("popup_opened")})),t.addEventListener("click",(e=>{let o=e.target;o.matches(".close-form img")?(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))):(o=o.closest(".form-content"),o||(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))))}))})(),(()=>{if(document.getElementById("price-total")){const e=document.getElementById("card_order"),t=document.querySelectorAll("input[name='card-type']"),o=document.getElementById("price-total"),n=document.getElementById("promo"),c=e=>e.match(/class="cost">\d+<span/g).filter((e=>!e.includes("day"))).map((e=>+e.replace(/\D/g,""))),s=e=>{t.forEach(((t,c)=>{t.dataset.price=e[c],t.checked&&(o.textContent=t.dataset.price,"ТЕЛО2020"===n.value&&(o.textContent=Math.round(.7*t.dataset.price)))})),document.querySelector(".time").addEventListener("change",(e=>{const t=e.target;t&&(o.textContent=t.dataset.price,"ТЕЛО2020"===n.value&&(o.textContent=Math.round(.7*t.dataset.price)))}))};fetch("./mozaika.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>c(e))).then((e=>{s(e)})).catch((e=>{console.error(e)})),e.addEventListener("change",(e=>{const t=e.target;t.matches("#card_leto_mozaika")&&fetch("./mozaika.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>c(e))).then((e=>{s(e)})).catch((e=>{console.error(e)})),t.matches("#card_leto_schelkovo")&&fetch("./schelkovo.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>c(e))).then((e=>{s(e)})).catch((e=>{console.error(e)}))})),n.addEventListener("input",(e=>{"ТЕЛО2020"===n.value?(n.style.border="2px solid green",o.textContent=Math.round(.7*o.textContent)):(n.style.border="",t.forEach((e=>{e.checked&&(o.textContent=e.dataset.price)})))}))}})(),(()=>{const e=document.getElementById("form1"),t=document.getElementById("form2"),o=document.querySelector(".preloader"),n=document.getElementById("card_order"),c=document.getElementById("thanks"),s=document.getElementById("thanks__error"),r=document.getElementById("promo"),a=document.getElementById("price-total"),l=document.querySelectorAll("input[name='card-type']");c.addEventListener("click",(e=>{let t=e.target;t.matches(".close-form img")||t.matches("#thanks .close-btn")?c.classList.remove("popup_opened"):(t=t.closest(".form-content"),t||c.classList.remove("popup_opened"))})),s.addEventListener("click",(e=>{let t=e.target;t.matches(".close-form img")||t.matches("#thanks__error .close-btn")?s.classList.remove("popup_opened"):(t=t.closest(".form-content"),t||s.classList.remove("popup_opened"))}));const d=(d,p)=>{p.preventDefault();const m=d.querySelector("[type='checkbox']"),i=d.querySelector("#personalDataAgreement");if(m&&!1===m.checked)return i.classList.add("popup_opened"),void(d===n&&(i.style.color="black",i.style.textAlign="left"));i&&i.classList.remove("popup_opened"),d===n&&r&&(r.style.border="",l.forEach((e=>{e.checked&&(a.textContent=e.dataset.price)}))),d.append(o),o.style.display="block";const u=new FormData(d),h={};for(const e of u.entries())h[e[0]]=e[1];(e=>fetch("./se4444rver.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(h).then((n=>{if(200!==n.status)throw new Error("network failed");o.style.display="none",d===e||d===t?(d.parentElement.parentElement.parentElement.classList.remove("popup_opened"),c.classList.add("popup_opened"),setTimeout((()=>{c.classList.remove("popup_opened")}),5e3)):(c.classList.add("popup_opened"),setTimeout((()=>{c.classList.remove("popup_opened")}),5e3))})).catch((n=>{console.error(n),o.style.display="none",d===e||d===t?(d.parentElement.parentElement.parentElement.classList.remove("popup_opened"),s.classList.add("popup_opened"),setTimeout((()=>{s.classList.remove("popup_opened")}),5e3)):(s.classList.add("popup_opened"),setTimeout((()=>{s.classList.remove("popup_opened")}),5e3))})),d.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&(e.checked=!1)}))};document.addEventListener("submit",(e=>{const t=e.target;t.matches("#form1")&&d(t,e),t.matches("#form2")&&d(t,e),t.matches("#banner-form")&&d(t,e),t.matches("#card_order")&&d(t,e),t.matches("#footer_form")&&d(t,e)}))})()})();