(()=>{"use strict";(()=>{const e=document.querySelector("ul"),t=()=>{e.classList.toggle("menu-active"),e.classList.toggle("animate__animated"),e.classList.toggle("animate__bounceInDown")};document.addEventListener("click",(o=>{let n=o.target;n.matches(".club-select p")?t():(n=n.closest(".club-select"),!n&&e.classList.contains("menu-active")&&t())}))})(),(()=>{const e=document.querySelector(".fixed-gift"),t=document.getElementById("gift"),o=document.querySelector("#gift .form-content"),n=()=>{t.classList.toggle("popup_opened")};e&&(e.addEventListener("click",(()=>{document.documentElement.clientWidth>768?(e.style.display="none",o.classList.add("animate__animated"),o.classList.add("animate__bounceIn"),n()):(e.style.display="none",n())})),t.addEventListener("click",(e=>{let t=e.target;t.matches(".close_icon")||t.matches(".close-btn")?n():(t=t.closest(".form-content"),t||n())})))})(),(()=>{const e=document.querySelector(".menu-button img"),t=document.querySelector(".popup-menu"),o=document.querySelector(".top-menu");e.addEventListener("click",(()=>{t.classList.add("animate__animated"),t.classList.add("animate__fadeIn"),t.classList.add("animate__faster"),t.style.display="flex"})),t.addEventListener("click",(e=>{const o=e.target;(o.matches(".close-menu-btn img")||o.matches(".popup-menu li a"))&&(t.style.display="none")})),window.addEventListener("scroll",(()=>{document.documentElement.clientWidth<768&&document.documentElement.scrollTop>o.offsetTop?o.classList.add("burger__fixed"):o.classList.remove("burger__fixed")}))})(),(()=>{const e=(e,t)=>{e.preventDefault();const o=t.getAttribute("href");document.querySelector(o).scrollIntoView({behavior:"smooth",block:"start"})};document.addEventListener("click",(t=>{let o=t.target;o.matches('a[href*="#"]')&&!o.matches(".open-popup")?e(t,o):(o=o.closest("#totop"),o&&e(t,o))}))})(),(()=>{const e=document.getElementById("totop");e.style.display="none",window.addEventListener("scroll",(()=>{window.pageYOffset>document.getElementById("header").offsetHeight?e.style.display="block":e.style.display="none"}))})(),(()=>{const e=document.querySelector(".open-popup"),t=document.getElementById("free_visit_form");e.addEventListener("click",(()=>{t.classList.add("popup_opened")})),t.addEventListener("click",(e=>{let o=e.target;o.matches(".close-form img")?(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))):(o=o.closest(".form-content"),o||(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))))}))})(),(()=>{const e=document.querySelector(".callback-btn"),t=document.getElementById("callback_form");e.addEventListener("click",(()=>{t.classList.add("popup_opened")})),t.addEventListener("click",(e=>{let o=e.target;o.matches(".close-form img")?(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))):(o=o.closest(".form-content"),o||(t.classList.remove("popup_opened"),t.querySelector("#personalDataAgreement")&&t.querySelector("#personalDataAgreement").classList.remove("popup_opened"),t.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&!0===e.checked&&(e.checked=!1)}))))}))})(),(()=>{if(document.getElementById("price-total")){const e=document.getElementById("card_order"),t=document.querySelectorAll("input[name='card-type']"),o=document.getElementById("price-total"),n=document.getElementById("promo"),c=e=>e.match(/class="cost">\d+<span/g).filter((e=>!e.includes("day"))).map((e=>+e.replace(/\D/g,""))),s=e=>{t.forEach(((t,c)=>{t.dataset.price=e[c],t.checked&&(o.textContent=t.dataset.price,"ТЕЛО2020"===n.value&&(o.textContent=Math.round(.7*t.dataset.price)))})),document.querySelector(".time").addEventListener("change",(e=>{const t=e.target;t&&(o.textContent=t.dataset.price,"ТЕЛО2020"===n.value&&(o.textContent=Math.round(.7*t.dataset.price)))}))};fetch("./mozaika.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>c(e))).then((e=>{s(e)})).catch((e=>{console.error(e)})),e.addEventListener("change",(e=>{const t=e.target;t.matches("#card_leto_mozaika")&&fetch("./mozaika.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>c(e))).then((e=>{s(e)})).catch((e=>{console.error(e)})),t.matches("#card_leto_schelkovo")&&fetch("./schelkovo.html").then((e=>{if(200!==e.status)throw new Error("Network failed");return e.text()})).then((e=>c(e))).then((e=>{s(e)})).catch((e=>{console.error(e)}))})),n.addEventListener("input",(e=>{"ТЕЛО2020"===n.value?(n.style.border="2px solid green",o.textContent=Math.round(.7*o.textContent)):(n.style.border="",t.forEach((e=>{e.checked&&(o.textContent=e.dataset.price)})))}))}})(),(()=>{const e=document.getElementById("form1"),t=document.getElementById("form2"),o=document.querySelector(".preloader"),n=document.getElementById("card_order"),c=document.getElementById("thanks"),s=document.getElementById("thanks__error"),a=document.getElementById("promo"),r=document.getElementById("price-total"),l=document.querySelectorAll("input[name='card-type']");c.addEventListener("click",(e=>{let t=e.target;t.matches(".close-form img")||t.matches("#thanks .close-btn")?c.classList.remove("popup_opened"):(t=t.closest(".form-content"),t||c.classList.remove("popup_opened"))})),s.addEventListener("click",(e=>{let t=e.target;t.matches(".close-form img")||t.matches("#thanks__error .close-btn")?s.classList.remove("popup_opened"):(t=t.closest(".form-content"),t||s.classList.remove("popup_opened"))}));const d=(d,p)=>{p.preventDefault();const i=d.querySelector("[type='checkbox']"),m=d.querySelector("#personalDataAgreement");if(i&&!1===i.checked)return m.classList.add("popup_opened"),void(d===n&&(m.style.color="black",m.style.textAlign="left"));m&&m.classList.remove("popup_opened"),d===n&&a&&(a.style.border="",l.forEach((e=>{e.checked&&(r.textContent=e.dataset.price)}))),d.append(o),o.style.display="block";const u=new FormData(d),h={};for(const e of u.entries())h[e[0]]=e[1];(e=>fetch("./se4444rver.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}))(h).then((n=>{if(200!==n.status)throw new Error("network failed");o.style.display="none",d===e||d===t?(d.parentElement.parentElement.parentElement.classList.remove("popup_opened"),c.classList.add("popup_opened"),setTimeout((()=>{c.classList.remove("popup_opened")}),5e3)):(c.classList.add("popup_opened"),setTimeout((()=>{c.classList.remove("popup_opened")}),5e3))})).catch((n=>{console.error(n),o.style.display="none",d===e||d===t?(d.parentElement.parentElement.parentElement.classList.remove("popup_opened"),s.classList.add("popup_opened"),setTimeout((()=>{s.classList.remove("popup_opened")}),5e3)):(s.classList.add("popup_opened"),setTimeout((()=>{s.classList.remove("popup_opened")}),5e3))})),d.querySelectorAll("input").forEach((e=>{e.value="","checkbox"===e.type&&(e.checked=!1)}))};document.addEventListener("submit",(e=>{const t=e.target;t.matches("#form1")&&d(t,e),t.matches("#form2")&&d(t,e),t.matches("#banner-form")&&d(t,e),t.matches("#card_order")&&d(t,e),t.matches("#footer_form")&&d(t,e)}))})(),document.addEventListener("input",(e=>{const t=e.target;t.matches("input[type='tel']")&&(t.value=t.value.replace(/[^\d+]/g,""),t.value.length>12&&(t.value=t.value.slice(0,12))),t.matches("input[name='name']")&&!t.matches("input#promo")&&(t.value=t.value.replace(/[^а-яё\s]/gi,"").replace(/\s+/g," ").replace(/^\s/g,""))})),document.addEventListener("blur",(e=>{const t=e.target;if(t.matches("input[type='tel']")&&"+"!==t.value.charAt(0)&&"7"!==t.value.charAt(1)&&(t.value="+7"+t.value.slice(2)),t.matches("input[name='name']")&&!t.matches("input#promo")&&""!==t.value.trim()){let e=t.value.split(/\s+/);if(e.length){let o=e.map((e=>{if(""!=e)return e[0].toUpperCase()+e.slice(1).toLowerCase()}));t.value=o.join(" ").replace(/\s$/g,"")}}}),!0),(()=>{const e=document.querySelector(".main-slider"),t=document.querySelectorAll(".main-slider .slide"),o=[];let n,c=0;(()=>{const e=document.querySelector(".header_slider-dots");for(let n=0;n<t.length;n++){const t=document.createElement("li");t.classList.add("dot"),0===n&&t.classList.add("dot-active"),o.push(t),e.appendChild(t)}})();const s=(e,t,o)=>{e[t].style.display=o},a=(e,t,o)=>{e[t].style.display=o},r=(e,t,o)=>{e[t].classList.remove(o)},l=(e,t,o)=>{e[t].classList.add(o)},d=()=>{s(t,c,"none"),r(o,c,"dot-active"),c++,c>=t.length&&(c=0),a(t,c,"block"),l(o,c,"dot-active")},p=(e=2e3)=>{n=setInterval(d,e)};e.addEventListener("click",(e=>{e.preventDefault();const n=e.target;n.matches(".dot")&&(s(t,c,"none"),r(o,c,"dot-active"),n.matches(".dot")&&o.forEach(((e,t)=>{e===n&&(c=t)})),c>=t.length&&(c=0),c<0&&(c=t.length-1),a(t,c,"block"),l(o,c,"dot-active"))})),e.addEventListener("mouseover",(e=>{e.target.matches(".dot")&&clearInterval(n)})),e.addEventListener("mouseout",(e=>{e.target.matches(".dot")&&p(5e3)})),p(5e3)})()})();